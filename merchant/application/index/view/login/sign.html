<!DOCTYPE html>
<html lang="en">
	<head>

		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>注册</title>
		
		<!--favicon -->
		<link rel="icon" href="/favicon.ico" type="image/x-icon"/>

		<!--Bootstrap.min css-->
		<link rel="stylesheet" href="__PLU__/bootstrap/css/bootstrap.min.css">
		
		<!--Icons css-->
		<link rel="stylesheet" href="__CSS__/icons.css">

		<!--Style css-->
		<link rel="stylesheet" href="__CSS__/style.css">

		<!--mCustomScrollbar css-->
		<link rel="stylesheet" href="__PLU__/scroll-bar/jquery.mCustomScrollbar.css">

		<!--Sidemenu css-->
		<link rel="stylesheet" href="__PLU__/toggle-menu/sidemenu.css">
		
		<style>
			.send{
				color:#fff!important;
				padding:2px 5px;
				font-size:12px;
				position: absolute;
				right:5px;
				top:5px;
			}
			.form-control{
				border-radius: 0;
				height:40px!important;
				padding:5px 15px!important;
				color:#000;
			}
			.form-control:focus{
				border-color: #ececff;
			}
			/*input[type='number']去掉箭头*/
			input[type='number']::-webkit-outer-spin-button,
			input[type='number']::-webkit-inner-spin-button{
				-webkit-appearance: none !important;
				margin: 0;
			}
			input[type="number"]{-moz-appearance:textfield;}
			/*输入框样式*/
    		select.form-control{
    		    font-size:12px!important;
    		    background-color: #fff;
    		}
    		.single-page .wrapper input{
    		    font-size:12px!important;
    		}

	
		</style>

	</head>

	<body class="bg-primary">
		<div id="app">
			<section class="section">
				<div class="container">
					<div class="row">
						<div class="single-page construction-bg single-pageimage cover-image" data-image-src="__IMG__/news/img14.jpg">
							<div class="row">
								<div class="col-lg-6">
									<div class="wrapper wrapper2">
										<form  class="card-body" tabindex="500">
											<h3>注册</h3>
											<div class="identity">
												<select class="form-control" id="type" name="type">
													<option value="shop">商家</option>
                                                    <option value="exshop">承兑商</option>
                                                    <option value="agency">代理商</option>
												</select>
												<label>角色</label>
											</div>
                                            <div class="password">
                                                <input type="text" name="mobile" id="mobile">
                                                <label>用户名<i style="color:red;">*</i></label>
                                            </div>
											<div class="regisStyle">
												<select class="form-control" id="usertype" name="usertype">
													<option value="mobile">手机号</option>
<!--													<option value="email">邮箱</option>-->
												</select>
												<label>注册方式</label>
											</div>
											<div class="mobile">
												<input type="text" name="username" id="username">
												<label>
													<span class="signtype">手机号</span>
													<i style="color:red;">*</i>
												</label>
											</div>
											<div class="code">
												<input type="number" name="veirfy" id="verify">
												<a class="btn btn-primary send">发送验证码</a>
												<label>短信验证码</label>
											</div>
											<div class="password">
												<input type="password" name="password" id="password">
												<label>密码</label>
											</div>
											<div class="password">
												<input type="password" name="repassword" id="repassword">
												<label>确认密码</label>
											</div>
											<div class="password">
												<input type="password" name="paypassword" id="paypassword">
												<label>支付密码</label>
											</div>
											<div class="name">
												<input type="text" name="nickname" id="nickname">
												<label>真实姓名</label>
											</div>
											<!--<div class="industy">-->
												<!--<select class="form-control" id="industry" name="industry">-->
													<!--<option value="IT">IT行业</option>-->
													<!--<option value="SERVE">服务行业</option>-->
												<!--</select>-->
												<!--<label>行业</label>-->
											<!--</div>-->
											<!--<div class="project">-->
												<!--<input type="text" name="project" id="project">-->
												<!--<label>项目名称</label>-->
											<!--</div>-->
											<div class="agency">
												<input type="text" name="inviter" id="inviter" value="{$Think.get.invit}">
												<label>上级代理</label>
											</div>
<!--                                            --><?php //$invit = print_r(array_reverse(explode('/',$_REQUEST['s']))[0]);?>
											<div class="submit">
												<a class="btn btn-primary btn-block" id="btc-sign" style="color:#fff">注册</a>
											</div>
											<p class="text-dark mb-0">
												<a href="{:url('index/index')}" class="text-primary ml-1 float-left" >官方首页</a>
												<a href="{:url('login/index')}" class="text-primary ml-1 float-right">登录</a>
											</p>											
										</form>
									</div>
								</div>
								<div class="col-lg-6">
									<div class="log-wrapper ">
										<div class="log-wrapper text-center ">
											<img src="__IMG__/brand/logo-white.png" class="mb-2 mt-4 mt-lg-0 " alt="logo">
											<p>There are many variations of passages of Lorem Ipsum available, but the majority have suffered alteration in some form, by injected humour, or randomised words which don't look even slightly believable.</p>
											<a class="btn btn-primary mt-3" href="#">Read More</a>
										</div>
									</div>
								</div>
							</div>
						</div>	
					</div>
				</div>
			</section>
		</div>

		<!--Jquery.min js-->
		<script src="__JS__/jquery.min.js"></script>

		<!--popper js-->
		<script src="__JS__/popper.js"></script>

		<!--Tooltip js-->
		<script src="__JS__/tooltip.js"></script>

		<!--Bootstrap.min js-->
		<script src="__PLU__/bootstrap/js/bootstrap.min.js"></script>

		<!--Jquery.nicescroll.min js-->
		<script src="__PLU__/nicescroll/jquery.nicescroll.min.js"></script>

		<!--Scroll-up-bar.min js-->
		<script src="__PLU__/scroll-up-bar/dist/scroll-up-bar.min.js"></script>
		<script src="__JS__/moment.min.js"></script>

		<!--mCustomScrollbar js-->
		<script src="__PLU__/scroll-bar/jquery.mCustomScrollbar.concat.min.js"></script>

		<!--Sidemenu js-->
		<script src="__PLU__/toggle-menu/sidemenu.js"></script>

		<!--Scripts js-->
		<script src="__JS__/scripts.js"></script>

		<script src="__JS__/layer.js"></script>
		<script>
			//角色选择
			$("#type").change(function(){
				var identity=$("#type option:selected").val();
				if(identity=="agency"){
					$(".industy").hide();
					$(".project").hide();
					$(".agency").hide();
				}else{
					$(".card-body>div").show();
				}
			});
			//注册方式选择
            $("#usertype").change(function(){
                var identity=$("#usertype option:selected").val();
                if(identity=="email"){
                    $(".signtype").html("邮箱账号");
                }
                if(identity=="mobile"){
                    $(".signtype").html("手机账号");
                }
            });
			  //获取验证码
            $('.send').on('click', function(){
                var username = $('#username').val();
                var usertype = $("#usertype").val();
                if(username==""|| username==null){
                    layer.msg('请输入用户名');
                    return false;
                }
				if(usertype=="mobile"){
                    if(!(/^1[34578]\d{9}$/.test(username))){
                        layer.msg('手机号码格式不正确');
                        return false;
                    }
                    var url="{:url('logincommon/sendsms')}";
				}
				if(usertype=="email"){
                    var reg = new RegExp("^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$");
                    if(!reg.test(username)){
                        layer.msg("邮箱格式不正确");
                        return false;
                    }
                    var url="{:url('logincommon/sendemail')}";
				}
                    $.ajax({
                        url:url,
                        data:{username:username},
                        dataType:'json',
                        type:'post',
                        success:function(data){
                            if(data.status==1){
                                timeClock(".send");
                                layer.msg(data.msg);
                            }else{
                                layer.msg(data.msg);
                            }
                        },
                        error:function(data){
                            console.log(data);
                        }
                    });
            });
			//手机验证码倒计时函数
			function timeClock(cls) {					
				var _this = $(cls);
				if(_this.hasClass('disabled')) {						
					return false;
				} else {
					_this.addClass('disabled');
					var i = 59;
					var int = setInterval(clock, 1000);

					function clock() {
						_this.text("重新发送"+"(" + i + ")");						
						i--;
						if(i < 0) {
							_this.removeClass('disabled');
							i = 59;
							_this.text("获取验证码");
							clearInterval(int);
						}
					}
					return false;
				}
			}
			$("#btc-sign").click(function(){

			    var type=$("#type").val();
                var username = $('#username').val();
                var nickname = $('#nickname').val();
                var usertype = $("#usertype").val();
                var verify=$("#verify").val();
                var password=$("#password").val();
                var repassword=$("#repassword").val();
                var paypassword=$("#paypassword").val();
                var inviter=$("#inviter").val();
                var mobile=$("#mobile").val();

                if(mobile=="" || mobile==null){
                    layer.msg("请填写用户名12");
                    return false;
                }
                if(username=="" || username==null){
                  	layer.msg("请填写手机号");
                  	return false;
				}
                if(nickname=="" || nickname==null){
                    layer.msg("请填写真实姓名");
                    return false;
                }
                if(verify=="" || verify==null){
                    layer.msg("请填写验证码");
                    return false;
                }
                if(password=="" || password==null){
                    layer.msg("请填写密码");
                    return false;
                }
                if(repassword=="" || repassword==null){
                    layer.msg("请填写确认密码");
                    return false;
                }
                if(paypassword=="" || paypassword==null){
                    layer.msg("请填写支付密码");
                    return false;
                }
				if(type=="shop"){
                    var sendData={
						username:username,
						type:type,
						verify:verify,
						password:password,
						repassword:repassword,
                        paypassword:paypassword,
						nickname:nickname,
						usertype:usertype,
                        inviter:inviter,
                        mobile:mobile,
					};
				}
				if(type=="agency"){
                    var sendData={
                        username:username,
						type:type,
                        verify:verify,
                        password:password,
                        repassword:repassword,
                        paypassword:paypassword,
                        nickname:nickname,
                        usertype:usertype,
                        mobile:mobile,
                    };
				}
                if(type=="exshop"){
                    var sendData={
                        username:username,
                        type:type,
                        verify:verify,
                        password:password,
                        repassword:repassword,
                        paypassword:paypassword,
                        nickname:nickname,
                        usertype:usertype,
                        inviter:inviter,
                        mobile:mobile,
                    };
                }
				console.log(sendData);

                $.ajax({
                    url:"{:url('login/sign')}",
                    data:sendData,
                    dataType:'json',
                    type:'post',
                    success:function(data){
                        if(data.status==1){
                            layer.msg(data.msg);
                           setTimeout(function(){
                             window.location.replace("{:url('login/index')}");
                           },2000)
                        }else{
                            layer.msg(data.msg);
                        }
                    },
                    error:function(data){
                        console.log(data);
                    }
                });
			});
		</script>
	</body>
</html>